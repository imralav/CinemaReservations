<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.1" xml:lang="pl-pl">
    <script src="js/vxmlapp.min.js"></script>
    <meta name="maintainer" content="imralav@gmail.com" />
    <var name="attempt" expr="1" />
    <script>
        dialogContext.setJokeLimitTo(2);
    </script>
    <form id="MainMenu">
        <block>
            <data name="jokeResponse" src="joke" />
            <log expr="'Received: ' + JSON.stringify(jokeResponse)"/>
            <assign name="document.jokeResponse" expr="jokeResponse.documentElement" />
            <log expr="'Document element: ' + jokeResponse"/>
            <log expr="'Joke: ' + dialogContext.getData(jokeResponse, 'joke')"/>
            <prompt>Dzień dobry. <value expr="dialogContext.getData(jokeResponse, 'joke')"/></prompt>
            <goto next="#Joke" />
        </block>
    </form>
    <form id="Joke">
        <block cond="dialogContext.shouldTellJoke()">
            <prompt>
                Oto żart numer
                <value expr="dialogContext.toldJokesAmount() + 1" />
                :
                <value expr="jokeProvider.next()"></value>
                ...
            </prompt>
            <goto next="#MainMenu" />
        </block>
    </form>
</vxml>